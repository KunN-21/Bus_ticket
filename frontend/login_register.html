<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Đăng nhập / Đăng ký - VOOBUS</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/styles/core/main.css">
  <link rel="stylesheet" href="assets/styles/components/header.css">
  <link rel="stylesheet" href="assets/styles/features/auth.css">
  <link rel="stylesheet" href="assets/styles/components/footer.css">
  <link rel="stylesheet" href="assets/styles/components/toast.css">
</head>
<body>
  <!-- Header (copied from index) -->
  <header class="header">
      <div class="container">
          <div class="header-content">
              <a href="index.html" class="logo">
                  <div class="logo-text">
                      <span class="logo-brand">VOOBUS</span>
                  </div>
              </a>

              <nav class="nav-menu">
                  <a href="index.html" class="nav-link">Trang chủ</a>
                  <a href="#schedule" class="nav-link">Lịch trình</a>
                  <a href="#lookup" class="nav-link">Tra cứu vé</a>
                  <a href="#invoice" class="nav-link">Hóa đơn</a>
                  <a href="#about" class="nav-link">Về chúng tôi</a>
              </nav>

              <div class="header-actions">
                  <button class="btn-language">
                      <img src="https://futabus.vn/images/icons/vietnam.svg" alt="VI" width="20">
                      VI
                  </button>
                  
                  <!-- Login Button (shown when not logged in) -->
                  <a href="login_register.html" class="btn-login" id="btnLogin">
                      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                          <circle cx="12" cy="7" r="4"></circle>
                      </svg>
                      Đăng nhập/Đăng ký
                  </a>

                  <!-- User Account Dropdown (shown when logged in) -->
                  <div class="user-account" id="userAccount" style="display: none;">
                      <button class="btn-account" onclick="toggleAccountMenu()">
                          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                              <circle cx="12" cy="7" r="4"></circle>
                          </svg>
                          <span id="userName">Tài khoản</span>
                          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="arrow-icon">
                              <polyline points="6 9 12 15 18 9"></polyline>
                          </svg>
                      </button>
                      <div class="account-dropdown" id="accountDropdown">
                          <div class="account-info">
                              <div class="account-avatar">
                                  <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                      <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                      <circle cx="12" cy="7" r="4"></circle>
                                  </svg>
                              </div>
                              <div class="account-details">
                                  <div class="account-name" id="dropdownUserName">User</div>
                                  <div class="account-email" id="dropdownUserEmail">email@example.com</div>
                              </div>
                          </div>
                          <div class="account-divider"></div>
                          <a href="#" class="account-menu-item" onclick="viewProfile()">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                  <circle cx="12" cy="7" r="4"></circle>
                              </svg>
                              Thông tin cá nhân
                          </a>
                          <a href="#" class="account-menu-item" onclick="viewBookings()">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                  <line x1="16" y1="2" x2="16" y2="6"></line>
                                  <line x1="8" y1="2" x2="8" y2="6"></line>
                                  <line x1="3" y1="10" x2="21" y2="10"></line>
                              </svg>
                              Vé của tôi
                          </a>
                          <a href="#" class="account-menu-item" onclick="viewHistory()">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                  <circle cx="12" cy="12" r="10"></circle>
                                  <polyline points="12 6 12 12 16 14"></polyline>
                              </svg>
                              Lịch sử đặt vé
                          </a>
                          <div class="account-divider"></div>
                          <a href="#" class="account-menu-item logout" onclick="logout()">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                                  <polyline points="16 17 21 12 16 7"></polyline>
                                  <line x1="21" y1="12" x2="9" y2="12"></line>
                              </svg>
                              Đăng xuất
                          </a>
                      </div>
                  </div>
              </div>

              <button class="mobile-menu-toggle" onclick="toggleMobileMenu()" title="Menu" aria-label="Toggle mobile menu">
                  <span></span>
                  <span></span>
                  <span></span>
              </button>
          </div>
      </div>
  </header>

  <!-- Auth Section -->
  <main>
    <section id="authSection" class="auth-section visible">
      <div class="container">
        <div class="auth-card">
          <button class="auth-close" id="authClose" aria-label="Đóng" onclick="window.location='index.html'">×</button>

          <div class="auth-left">
            <div class="auth-brand">
              <img src="/assets/images/logo.png" alt="logo" class="auth-logo" onerror="this.style.display='none'">
            </div>
            <div class="auth-illustration">
              <img src="/assets/images/auth-banner.png" alt="banner" onerror="this.style.display='none'">
            </div>
          </div>

          <div class="auth-right">
            <div class="auth-header">
              <h3>Đăng nhập tài khoản</h3>
              <div class="auth-tabs">
                <button class="tab active" data-tab="login">ĐĂNG NHẬP</button>
                <button class="tab" data-tab="register">ĐĂNG KÝ</button>
              </div>
            </div>

            <div class="auth-body">
              <!-- Login Form -->
              <div id="loginFormWrapper" class="auth-form-wrapper active">
                <form id="loginFormElement">
                  <label class="input-label">Email</label>
                  <input type="email" name="email" class="input" placeholder="you@example.com" required />

                  <label class="input-label mt-15">Mật khẩu</label>
                  <div class="input-with-icon">
                    <input type="password" id="loginPassword" name="password" class="input" placeholder="Nhập mật khẩu" required />
                    <button type="button" class="icon-btn" onclick="togglePassword('loginPassword')" aria-label="Hiện/ẩn mật khẩu">
                      <svg width="18" height="12" viewBox="0 0 24 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M1 7C1 7 5 1 12 1s11 6 11 6-4 6-11 6S1 7 1 7z" stroke="#666" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="12" cy="7" r="2" fill="#666" />
                      </svg>
                    </button>
                  </div>

                  <button type="submit" class="btn btn-primary">Đăng nhập</button>
                  <p class="auth-help"><a href="#">Quên mật khẩu?</a></p>
                </form>
              </div>

              <!-- Step 1: Register Email Form -->
              <div id="registerEmailForm" class="auth-form-wrapper">
                <form id="registerEmailFormElement">
                  <label class="input-label">Email đăng ký</label>
                  <input type="email" name="email" class="input" placeholder="you@example.com" required />
                  <small class="muted">Chúng tôi sẽ gửi mã OTP xác thực đến email này.</small>
                  <button type="submit" class="btn btn-primary">Gửi mã OTP</button>
                </form>
              </div>

              <!-- Step 2: Verify OTP Form -->
              <div id="verifyOTPForm" class="auth-form-wrapper">
                <p class="auth-subtitle">Mã OTP đã được gửi đến:</p>
                <div class="email-display" id="displayEmail">email@example.com</div>
                <form id="verifyOTPFormElement">
                  <label class="input-label mt-15">Nhập mã OTP (6 số)</label>
                  <input type="text" id="otpCode" name="otp" class="input" placeholder="000000" maxlength="6" required />
                  <button type="submit" class="btn btn-primary">Xác thực OTP</button>
                  <button type="button" id="resendOTP" class="btn btn-secondary">Gửi lại mã OTP</button>
                  <p class="auth-help"><a href="#" id="backToEmail">← Quay lại nhập email</a></p>
                </form>
              </div>

              <!-- Step 3: Set Password Form -->
              <div id="setPasswordForm" class="auth-form-wrapper">
                <h4 style="margin-bottom:10px;">Tạo mật khẩu</h4>
                <form id="setPasswordFormElement">
                  <label class="input-label">Mật khẩu mới</label>
                  <div class="input-with-icon">
                    <input type="password" id="newPassword" name="password" class="input" placeholder="Nhập mật khẩu (tối thiểu 6 ký tự)" required />
                    <button type="button" class="icon-btn" onclick="togglePassword('newPassword')" aria-label="Hiện/ẩn mật khẩu">
                      <svg width="18" height="12" viewBox="0 0 24 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M1 7C1 7 5 1 12 1s11 6 11 6-4 6-11 6S1 7 1 7z" stroke="#666" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="12" cy="7" r="2" fill="#666" />
                      </svg>
                    </button>
                  </div>

                  <label class="input-label mt-15">Xác nhận mật khẩu</label>
                  <div class="input-with-icon">
                    <input type="password" id="confirmPassword" name="confirmPassword" class="input" placeholder="Nhập lại mật khẩu" required />
                    <button type="button" class="icon-btn" onclick="togglePassword('confirmPassword')" aria-label="Hiện/ẩn mật khẩu">
                      <svg width="18" height="12" viewBox="0 0 24 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M1 7C1 7 5 1 12 1s11 6 11 6-4 6-11 6S1 7 1 7z" stroke="#666" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="12" cy="7" r="2" fill="#666" />
                      </svg>
                    </button>
                  </div>

                  <button type="submit" class="btn btn-primary">Tiếp tục</button>
                </form>
              </div>

              <!-- Step 4: Complete Registration Form -->
              <div id="completeRegistrationForm" class="auth-form-wrapper">
                <h4 style="margin-bottom:10px;">Hoàn tất đăng ký</h4>
                <form id="completeRegistrationFormElement">
                  <label class="input-label">Họ và tên</label>
                  <input type="text" name="hoTen" class="input" placeholder="Nguyễn Văn A" required />

                  <label class="input-label mt-15">Số điện thoại</label>
                  <input type="text" id="phoneNumber" name="SDT" class="input" placeholder="0987654321" maxlength="10" required />

                  <label class="input-label mt-15">Số CCCD</label>
                  <input type="text" id="idCard" name="CCCD" class="input" placeholder="001234567890" maxlength="12" required />

                  <label class="input-label mt-15">Địa chỉ</label>
                  <textarea id="address" name="diaChi" class="input" rows="3" placeholder="Địa chỉ của bạn" required></textarea>

                  <button type="submit" class="btn btn-primary">Hoàn tất đăng ký</button>
                </form>
              </div>
            </div>

            <!-- Loading Overlay -->
            <div class="loading-overlay" id="loading">
              <div class="spinner"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer (copied from index) -->
  <footer class="footer">
      <div class="container">
          <div class="footer-grid">
              <div class="footer-column">
                  <h3>CÔNG TY VOOBUS</h3>
                  <p><strong>Dịch Vụ Vận Chuyển Chuyên Nghiệp</strong></p>
                  <p>Địa chỉ: Cộng Hòa, TP. Hồ Chí Minh, Việt Nam</p>
                  <p>Email: <a href="mailto:support@voobus.vn">support@voobus.vn</a></p>
                  <p>Điện thoại: <a href="tel:02837123456">028 3712 3456</a></p>
                  <p>Fax: <a href="tel:02838123457">028 7812 3857</a></p>
              </div>

              <div class="footer-column">
                  <h4>Về Chúng Tôi</h4>
                  <ul class="footer-links">
                      <li><a href="#about">Giới thiệu công ty</a></li>
                      <li><a href="#terms">Điều khoản sử dụng</a></li>
                      <li><a href="#privacy">Chính sách bảo mật</a></li>
                      <li><a href="#faq">Câu hỏi thường gặp</a></li>
                  </ul>
              </div>

              <div class="footer-column">
                  <h4>Hỗ Trợ Khách Hàng</h4>
                  <ul class="footer-links">
                      <li><a href="#guide-web">Hướng dẫn đặt vé online</a></li>
                      <li><a href="#guide-app">Hướng dẫn sử dụng App</a></li>
                      <li><a href="#network">Mạng lưới chi nhánh</a></li>
                      <li><a href="#recruitment">Tuyển dụng</a></li>
                  </ul>
              </div>

              <div class="footer-column">
                  <h4>KẾT NỐI VỚI CHÚNG TÔI</h4>
                  <div class="social-links">
                      <a href="#" target="_blank">
                          <svg width="32" height="32" viewBox="0 0 24 24" fill="#1877f2">
                              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                          </svg>
                      </a>
                      <a href="#" target="_blank">
                          <svg width="32" height="32" viewBox="0 0 24 24" fill="#ff0000">
                              <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                          </svg>
                      </a>
                  </div>
              </div>
          </div>

          <div class="footer-bottom">
              <p>© 2025 VOOBUS - Hệ Thống Đặt Vé Xe Khách. Bảo lưu mọi quyền.</p>
          </div>
      </div>
  </footer>

  <script src="assets/scripts/core/toast.js"></script>
  <script src="assets/scripts/core/main.js"></script>
  <script src="assets/scripts/features/auth.js"></script>
  
  <!-- Initialize login status check for auth page -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      checkLoginStatus();
    });
  </script>
</body>
</html>